<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>角色設定表單</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      justify-content: space-between;
      padding: 20px;
    }

    form {
      flex: 1;
    }

    .attributes {
      flex: 1;
      margin-left: 40px;
      border-left: 1px solid #ccc;
      padding-left: 20px;
    }

    .attribute-group {
      margin-bottom: 10px;
    }

    button {
      margin-left: 5px;
    }

    .remaining {
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <form>
    <!-- 職業下拉選單 -->
    <label for="job">職業: </label>
    <select id="job" name="job">
      <option value="法師">法師</option>
      <option value="劍士 (龍騎士)">劍士 (龍騎士)</option>
      <option value="劍士 (十字軍)">劍士 (十字軍)</option>
      <option value="劍士 (騎士)">劍士 (騎士)</option>
      <option value="盜賊 (神偷)">盜賊 (神偷)</option>
      <option value="盜賊 (暗殺者)">盜賊 (暗殺者)</option>
      <option value="弓箭手">弓箭手</option>
      <option value="海盜 (槍手)">海盜 (槍手)</option>
    </select>
    <br><br>

    <!-- 等級 -->
    <label for="level">等級: </label>
    <input type="number" id="level" name="level" min="1" max="200" value="1" required>
    <br><br>

    <!-- 武器精準技能 -->
    <label for="accuracy">武器精準技能 (0~20): </label>
    <input type="number" id="accuracy" name="accuracy" min="0" max="20" value="0" required>
    <br><br>

    <!-- 可分配能力值 -->
    <div>
      可分配能力值總數: <span id="points">9</span>
    </div>
  </form>

  <div class="attributes">
    <h3>能力值</h3>
    <div class="attribute-group">
      <label>力量: </label>
      <button type="button" onclick="changeAttr('str', -1)">-</button>
      <span id="str">4</span>
      <button type="button" onclick="changeAttr('str', 1)">+</button>
    </div>
    <div class="attribute-group">
      <label>敏捷: </label>
      <button type="button" onclick="changeAttr('dex', -1)">-</button>
      <span id="dex">4</span>
      <button type="button" onclick="changeAttr('dex', 1)">+</button>
    </div>
    <div class="attribute-group">
      <label>智慧: </label>
      <button type="button" onclick="changeAttr('int', -1)">-</button>
      <span id="int">4</span>
      <button type="button" onclick="changeAttr('int', 1)">+</button>
    </div>
    <div class="attribute-group">
      <label>幸運: </label>
      <button type="button" onclick="changeAttr('luk', -1)">-</button>
      <span id="luk">4</span>
      <button type="button" onclick="changeAttr('luk', 1)">+</button>
    </div>

    <button type="button" onclick="resetAttributes()">重置能力值</button>

    <div class="remaining">
      剩餘可用能力值點數: <span id="remaining">9</span>
    </div>
  </div>

  <script>
    const baseValue = 4;
    const attributes = ["str", "dex", "int", "luk"];

    function getLevelPoints() {
      const level = parseInt(document.getElementById("level").value) || 1;
      return (level - 1) * 5 + 9;
    }

    function getTotalAllocatablePoints() {
      return getLevelPoints() + baseValue * attributes.length;
    }

    function getCurrentTotalUsedPoints() {
      return attributes.reduce((sum, attr) => {
        const val = parseInt(document.getElementById(attr).textContent);
        return sum + val;
      }, 0);
    }

    function updatePointsDisplay() {
      const totalPoints = getLevelPoints();
      const totalAllocatable = getTotalAllocatablePoints();
      const used = getCurrentTotalUsedPoints();
      document.getElementById("points").textContent = totalPoints;
      document.getElementById("remaining").textContent = totalAllocatable - used;
    }

    function changeAttr(attr, delta) {
      const span = document.getElementById(attr);
      let value = parseInt(span.textContent);
      const used = getCurrentTotalUsedPoints();
      const total = getTotalAllocatablePoints();

      if (delta === 1 && used < total) {
        span.textContent = value + 1;
      } else if (delta === -1 && value > baseValue) {
        span.textContent = value - 1;
      }

      updatePointsDisplay();
    }

    function resetAttributes() {
      attributes.forEach(attr => {
        document.getElementById(attr).textContent = baseValue;
      });
      updatePointsDisplay();
    }

    document.getElementById("level").addEventListener("input", () => {
      updatePointsDisplay();
      resetAttributes(); // 等級改變時也重置能力值
    });

    window.addEventListener("DOMContentLoaded", updatePointsDisplay);
  </script>
</body>
</html>
